# DOCKER COMPOSE "Hospedando um site com banco de dados Mongodb"

![Prometheus](./projeto_obs/image.png)

**Objetivo**:

O projeto de observabilidade com Prometheus visa oferecer uma solu√ß√£o abrangente para monitorar e analisar o desempenho de uma aplica√ß√£o Java em tempo real. Com uma abordagem proativa, o sistema permite identificar, diagnosticar e resolver potenciais problemas antes que impactem significativamente a experi√™ncia do usu√°rio final.


## üìå Requisitos

Ambiente de Desenvolvimento Integrado (IDE):
Para o desenvolvimento da aplica√ß√£o Java e a gest√£o de suas depend√™ncias, √© necess√°rio o uso de uma IDE adequada. Recomenda-se o uso do Eclipse devido √† sua integra√ß√£o nativa com o Maven, o que simplifica o processo de gerenciamento de depend√™ncias.

Docker e Docker-Compose:
O projeto faz uso das tecnologias Docker e Docker-Compose para facilitar a configura√ß√£o e a implanta√ß√£o de ambientes de desenvolvimento e produ√ß√£o. Essas ferramentas fornecem uma maneira consistente e eficiente de empacotar, distribuir e executar a aplica√ß√£o em diferentes ambientes.

Java JDK 1.8.0_312:
O ambiente de desenvolvimento requer o Java Development Kit (JDK) vers√£o 1.8.0_312 ou superior. Esta vers√£o espec√≠fica do JDK foi selecionada devido √† compatibilidade com as depend√™ncias e bibliotecas utilizadas no projeto.

Maven:
O Maven √© uma ferramenta de automa√ß√£o de compila√ß√£o amplamente utilizada no ecossistema Java. Ele √© usado para gerenciar depend√™ncias, compilar o c√≥digo-fonte, executar testes e criar artefatos de distribui√ß√£o da aplica√ß√£o. √â fundamental que o Maven esteja instalado e configurado corretamente no ambiente de desenvolvimento.


## üì¶ Documenta√ß√£o

**Actuator**

Ao adicionar o Spring Boot Actuator ao projeto, estamos habilitando uma s√©rie de funcionalidades poderosas para monitoramento e gerenciamento da aplica√ß√£o. Abaixo est√° aprimorada a descri√ß√£o do processo de adi√ß√£o e configura√ß√£o do Actuator, juntamente com algumas explica√ß√µes adicionais:

Depend√™ncia Maven:
O Spring Boot Actuator √© adicionado como uma depend√™ncia no arquivo pom.xml do projeto Maven. Isso permite que o Maven gerencie automaticamente as depend√™ncias necess√°rias para o projeto. Aqui est√° a configura√ß√£o da depend√™ncia:

```
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-actuator</artifactId>
    </dependency>
</dependencies>
```

Certifique-se de incluir esta configura√ß√£o dentro da se√ß√£o <dependencies> do seu arquivo pom.xml.

Configura√ß√£o do Actuator:
O arquivo application.properties (ou application.yml) √© usado para configurar o comportamento do Spring Boot Actuator. Aqui, estabelecemos quais endpoints devem ser expostos e quais detalhes devem ser exibidos. Por exemplo:

```
# Configura√ß√£o do Actuator
management.endpoint.health.show-details=always
management.endpoints.web.exposure.include=health,info,metrics
```

*management.endpoint.health.show-details=always:* Define que os detalhes completos do endpoint de sa√∫de (/actuator/health) devem ser mostrados sempre que consultados.
*management.endpoints.web.exposure.include=health,info,metrics:* Especifica quais endpoints do Actuator devem ser expostos. Neste caso, estamos expondo os endpoints de sa√∫de, 
informa√ß√µes e m√©tricas, que s√£o essenciais para monitoramento e gerenciamento da aplica√ß√£o.

*Considera√ß√µes sobre Endpoints:*
Os endpoints health, info e metrics fornecem informa√ß√µes cruciais sobre o estado da aplica√ß√£o, informa√ß√µes adicionais sobre a aplica√ß√£o e m√©tricas de desempenho, respectivamente. √â importante ressaltar que esses endpoints s√£o destinados ao uso interno e n√£o devem ser expostos publicamente. Em um ambiente de produ√ß√£o, √© fundamental proteger esses endpoints de acesso n√£o autorizado.

**Subindo nossos containers com o docker compose**

Apos configurar as dependencias, podemos subir nossos containers para isso vamos utilizar o comando:

```
docker compose up -d

```

![1](./projeto_obs/01.png)

**Compilamos a aplica√ß√£o**

Tamb√©m bildamos a aplica√ß√£o usando o maven, N√£o vamos entrar em detalhes pois n√£o e o foco do projeto.

![2](./projeto_obs/02.png)


**Nossa aplica√ß√£o funcionando corretamente**

Podemos verificar que nossa aplica√ß√£o subiu corretamente e esta funcionando ao acessar localhost:8080/topicos

![3](./projeto_obs/03.png)


Tamb√©m podemos verificar que o actuator esta funcionando, basta acessar localhost:8080/actuator

![4](./projeto_obs/04.png)


**Simula√ß√£o de Consumo de API para M√©tricas no Prometheus**

Para enriquecer as m√©tricas coletadas pelo Prometheus e garantir uma vis√£o abrangente do desempenho da aplica√ß√£o, ser√° implementado um container cliente que simular√° o consumo da API. Este container executar√° um script que realizar√° requisi√ß√µes √† API, tanto corretas quanto com erros, com o objetivo de gerar m√©tricas relevantes para monitoramento.

![6](./projeto_obs/06.png)


**Prometheus**

Apos alimentar nossa API, podemos acessar o Prometheus no localhost:9090

![5](./projeto_obs/05.png)

**PAnatomia e Tipos de Dados das M√©tricas no Prometheus**

***Anatomia das M√©tricas:***

*Nome da M√©trica (Metric Name):* √â o identificador √∫nico da m√©trica e descreve a informa√ß√£o sendo coletada. Exemplo: http_requests_total, que representa o n√∫mero total de requisi√ß√µes HTTP.

*R√≥tulos (Labels):* Os r√≥tulos s√£o pares chave-valor que identificam diferentes s√©ries temporais dentro de uma m√©trica. Eles permitem a segmenta√ß√£o e filtragem dos dados. Exemplo: {method="GET", status="200"}.

*Amostra (Sample):* √â o valor num√©rico da m√©trica em um ponto espec√≠fico no tempo. Ele √© representado pelo valor da m√©trica na s√©rie temporal identificada pelos r√≥tulos. Exemplo: 123.

***Tipos de Dados das M√©tricas:***

*Vetor Instant√¢neo (Instant Vector):* Representa um √∫nico valor para cada s√©rie temporal no momento da consulta. Por exemplo, ao consultar a m√©trica http_requests_total, um vetor instant√¢neo poderia retornar o n√∫mero total de requisi√ß√µes HTTP no momento da consulta para cada conjunto √∫nico de r√≥tulos.

*Vetor de Intervalo (Range Vector):* Representa um conjunto de valores para cada s√©rie temporal em um intervalo de tempo espec√≠fico. Por exemplo, ao consultar a m√©trica http_requests_total ao longo de um per√≠odo de 5 minutos, um vetor de intervalo poderia retornar o n√∫mero total de requisi√ß√µes HTTP para cada conjunto √∫nico de r√≥tulos durante esse intervalo de tempo.

*Float (Ponto Flutuante):*Representa valores num√©ricos de ponto flutuante, como contadores ou tempos de resposta. S√£o usados para quantidades que podem variar continuamente. Exemplo: 3.14.

*String (Texto):* Representa valores de texto. Geralmente, n√£o s√£o utilizados para m√©tricas num√©ricas, mas podem ser usados para rotular ou identificar s√©ries temporais. Por exemplo, um r√≥tulo de status HTTP como "200 OK".

**üî• Conclus√£o üî•**

Ap√≥s completarmos todas as configura√ß√µes necess√°rias, o Prometheus est√° agora monitorando nossa aplica√ß√£o. Isso nos permite acessar diversas m√©tricas importantes para avaliar o desempenho e a sa√∫de do nosso sistema. Por exemplo:

![5](./projeto_obs/08.png)
![5](./projeto_obs/09.png)
![5](./projeto_obs/11.png)



**Vamos utilizar esse projeto como base para implementar o Grafana**

‚å®Ô∏è com ‚ù§Ô∏è por [Elias Assun√ß√£o](https://github.com/Hooligam) üî•

